[2024-03-25 15:40:58,823] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:02,498] [WARNING] [runner.py:203:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-03-25 15:41:02,521] [INFO] [runner.py:570:main] cmd = /home/nfs02/anaconda3/envs/wzjsz/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=9901 --enable_each_rank_log=None src/train_bash.py --deepspeed /home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json --stage pt --model_name_or_path /home/nfs02/model/phi-2 --do_train --dataset ar_1b --preprocessing_num_workers 16 --cutoff_len 1024 --finetuning_type full --output_dir /home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b --overwrite_output_dir --per_device_train_batch_size 8 --gradient_accumulation_steps 8 --lr_scheduler_type cosine --logging_steps 10 --save_total_limit 1 --save_only_model --save_steps 100000 --learning_rate 5e-5 --num_train_epochs 1.0 --plot_loss --fp16
[2024-03-25 15:41:04,213] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:06,603] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2024-03-25 15:41:06,603] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=4, node_rank=0
[2024-03-25 15:41:06,603] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2024-03-25 15:41:06,603] [INFO] [launch.py:163:main] dist_world_size=4
[2024-03-25 15:41:06,603] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2024-03-25 15:41:12,202] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:12,203] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:12,204] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:12,206] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-25 15:41:19,961] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-25 15:41:19,961] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-25 15:41:19,961] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-25 15:41:19,962] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-03-25 15:41:19,962] [INFO] [comm.py:637:init_distributed] cdb=None
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Process rank: 2, device: cuda:2, n_gpu: 1
  distributed training: True, compute dtype: torch.float16
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1
  distributed training: True, compute dtype: torch.float16
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=True,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=8,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=2,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b/runs/Mar25_15-41-19_v100-32,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=cosine,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
output_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
save_on_each_node=False,
save_only_model=True,
save_safetensors=True,
save_steps=100000,
save_strategy=steps,
save_total_limit=1,
seed=42,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=True,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=8,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b/runs/Mar25_15-41-19_v100-32,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=cosine,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
output_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
save_on_each_node=False,
save_only_model=True,
save_safetensors=True,
save_steps=100000,
save_strategy=steps,
save_total_limit=1,
seed=42,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Process rank: 1, device: cuda:1, n_gpu: 1
  distributed training: True, compute dtype: torch.float16
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Process rank: 3, device: cuda:3, n_gpu: 1
  distributed training: True, compute dtype: torch.float16
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=True,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=8,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=1,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b/runs/Mar25_15-41-19_v100-32,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=cosine,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
output_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
save_on_each_node=False,
save_only_model=True,
save_safetensors=True,
save_steps=100000,
save_strategy=steps,
save_total_limit=1,
seed=42,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
03/25/2024 15:41:20 - INFO - llmtuner.hparams.parser - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=/home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=True,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=8,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=3,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b/runs/Mar25_15-41-19_v100-32,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=steps,
lr_scheduler_kwargs={},
lr_scheduler_type=cosine,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=1.0,
optim=adamw_torch,
optim_args=None,
output_dir=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=/home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b,
save_on_each_node=False,
save_only_model=True,
save_safetensors=True,
save_steps=100000,
save_strategy=steps,
save_total_limit=1,
seed=42,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2027] 2024-03-25 15:41:20,997 >> loading file tokenizer.json
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[WARNING|logging.py:314] 2024-03-25 15:41:21,080 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:727] 2024-03-25 15:41:21,081 >> loading configuration file /home/nfs02/model/phi-2/config.json
[INFO|configuration_utils.py:727] 2024-03-25 15:41:21,085 >> loading configuration file /home/nfs02/model/phi-2/config.json
[INFO|configuration_utils.py:792] 2024-03-25 15:41:21,086 >> Model config PhiConfig {
  "_name_or_path": "/home/nfs02/model/phi-2",
  "architectures": [
    "PhiForCausalLM"
  ],
  "attention_dropout": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_phi.PhiConfig",
    "AutoModelForCausalLM": "modeling_phi.PhiForCausalLM"
  },
  "bos_token_id": 50256,
  "embd_pdrop": 0.0,
  "eos_token_id": 50256,
  "hidden_act": "gelu_new",
  "hidden_size": 2560,
  "initializer_range": 0.02,
  "intermediate_size": 10240,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 2048,
  "model_type": "phi",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "partial_rotary_factor": 0.4,
  "qk_layernorm": false,
  "resid_pdrop": 0.1,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "float16",
  "transformers_version": "4.38.0.dev0",
  "use_cache": true,
  "vocab_size": 51200
}

[INFO|modeling_utils.py:3334] 2024-03-25 15:41:21,244 >> loading weights file /home/nfs02/model/phi-2/model.safetensors.index.json
[INFO|modeling_utils.py:1459] 2024-03-25 15:41:21,245 >> Instantiating PhiForCausalLM model under default dtype torch.float16.
[INFO|configuration_utils.py:827] 2024-03-25 15:41:21,246 >> Generate config GenerationConfig {
  "bos_token_id": 50256,
  "eos_token_id": 50256
}

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.83it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.85it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.94it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  4.38it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.23it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.17it/s]
03/25/2024 15:41:22 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
03/25/2024 15:41:22 - INFO - llmtuner.model.adapter - Fine-tuning method: Full
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.25it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.18it/s]
[INFO|modeling_utils.py:4070] 2024-03-25 15:41:22,840 >> All model checkpoint weights were used when initializing PhiForCausalLM.

[INFO|modeling_utils.py:4078] 2024-03-25 15:41:22,840 >> All the weights of PhiForCausalLM were initialized from the model checkpoint at /home/nfs02/model/phi-2.
If your task is similar to the task the model of the checkpoint was trained on, you can already use PhiForCausalLM for predictions without further training.
[INFO|configuration_utils.py:780] 2024-03-25 15:41:22,843 >> loading configuration file /home/nfs02/model/phi-2/generation_config.json
[INFO|configuration_utils.py:827] 2024-03-25 15:41:22,844 >> Generate config GenerationConfig {
  "bos_token_id": 50256,
  "eos_token_id": 50256
}

03/25/2024 15:41:22 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
03/25/2024 15:41:22 - INFO - llmtuner.model.adapter - Fine-tuning method: Full
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.02it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  5.01it/s]
03/25/2024 15:41:22 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
03/25/2024 15:41:22 - INFO - llmtuner.model.adapter - Fine-tuning method: Full
Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.65it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  4.60it/s]
03/25/2024 15:41:22 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
03/25/2024 15:41:22 - INFO - llmtuner.model.adapter - Fine-tuning method: Full
03/25/2024 15:41:27 - INFO - llmtuner.model.loader - trainable params: 2779683840 || all params: 2779683840 || trainable%: 100.0000
03/25/2024 15:41:27 - INFO - llmtuner.data.template - Add pad token: <|endoftext|>
03/25/2024 15:41:27 - INFO - llmtuner.model.loader - trainable params: 2779683840 || all params: 2779683840 || trainable%: 100.0000
03/25/2024 15:41:27 - INFO - llmtuner.data.template - Add pad token: <|endoftext|>
03/25/2024 15:41:27 - INFO - llmtuner.model.loader - trainable params: 2779683840 || all params: 2779683840 || trainable%: 100.0000
03/25/2024 15:41:27 - INFO - llmtuner.data.template - Add pad token: <|endoftext|>
03/25/2024 15:41:27 - INFO - llmtuner.model.loader - trainable params: 2779683840 || all params: 2779683840 || trainable%: 100.0000
03/25/2024 15:41:27 - INFO - llmtuner.data.template - Add pad token: <|endoftext|>
03/25/2024 15:41:30 - WARNING - llmtuner.data.utils - Checksum failed: mismatched SHA-1 hash value at data/ar_1b.jsonl.
Using custom data configuration default-59cb3ddd10a01018
Loading Dataset Infos from /home/nfs02/anaconda3/envs/wzjsz/lib/python3.10/site-packages/datasets/packaged_modules/json
Overwrite dataset info from restored data version if exists.
Loading Dataset info from /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96
Found cached dataset json (/home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96)
Loading Dataset info from /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96
Dataset({
    features: ['text'],
    num_rows: 369160
})
{'text': 'قال وزير تونسي إن الوفد اليهودي الفرنسي، غادر ملتقى "سفراء الحوار بين الأديان"، الذي انطلق بتونس يوم الأحد، "تجنبًا لأي لبس".\nوأوضح وزير الشؤون الدينية، أحمد عظوم، في تصريحات إعلاميّة، أن الوفد اليهودي الفرنسي "غير معني" بقرار قضائي تونسي يقضي بمنع منظمة الكشافة التونسية من قبول مشاركين إسرائيليين في هذا الملتقى.\nوقال عظوم، في كلمته أمام الملتقى، إنّ الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، يُساهم في التعايش السلمي ونبذ التطرف والعنف.\nوأشار إلى أنّ "وحدة الصف بين الشعوب في هذه اللحظة الفارقة، هي الضامن للتعايش السلمي بعيدًا عن الكراهية والتعصب على أساس الدين".\nمن جانبه، اعتبر القائد العام للكشافة التونسية، وحيد العبيدي، في كلمته، أن "الملتقى مناسبة لدفع مسار الحوار بين الأديان والثقافات ولتوفير الأمن والسلم".\nوأشار إلى أن 24 جنسية موزعين على 6 ديانات، يشاركون في هذا الملتقى العالمي الأول من نوعه، والذّي يتواصل حتى 8 نوفمبر/تشرين الثاني الجاري.\nويختتم الملتقى أعماله بإصدار "وثيقة تونس" لسفراء الحوار بين الأديان التي ستشكل لبنة أولى، لخلق منابر حوار داخل المنظمات الكشفية خلال المؤتمرات العالمية المقبلة.\nوانطلقت في مدينة الحمامات التونسية، مساء الأحد، أعمال الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، بمشاركة أكثر 150 شخصًا من 24 دولة.\nويهدف الملتقى، الذي يستمر 4 أيام، للعمل على تبني الحوار في المناهج الكشفية، وترسيخ ثقافة الحوار والتعايش بين الأديان.\nأصيب، اليوم الاثنين، مواطن، بالرصاص الحي عقب اقتحام قوات الاحتلال منزله واعتقال نجله في بلدة حلحول شمال الخليل، جنوب الضفة الغربية.'}
Process #0 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00000_of_00016.arrow
Process #1 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00001_of_00016.arrow
Process #2 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00002_of_00016.arrow
Process #3 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00003_of_00016.arrow
Process #4 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00004_of_00016.arrow
Process #5 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00005_of_00016.arrow
Process #6 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00006_of_00016.arrow
Process #7 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00007_of_00016.arrow
Process #8 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00008_of_00016.arrow
Process #9 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00009_of_00016.arrow
Process #10 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00010_of_00016.arrow
Process #11 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00011_of_00016.arrow
Process #12 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00012_of_00016.arrow
Process #13 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00013_of_00016.arrow
Process #14 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00014_of_00016.arrow
Process #15 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_00015_of_00016.arrow
Loading cached processed dataset at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-6129162dd7223443_*_of_00016.arrow
Concatenating 16 shards
Process #0 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00000_of_00016.arrow
Process #1 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00001_of_00016.arrow
Process #2 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00002_of_00016.arrow
Process #3 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00003_of_00016.arrow
Process #4 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00004_of_00016.arrow
Process #5 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00005_of_00016.arrow
Process #6 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00006_of_00016.arrow
Process #7 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00007_of_00016.arrow
Process #8 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00008_of_00016.arrow
Process #9 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00009_of_00016.arrow
Process #10 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00010_of_00016.arrow
Process #11 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00011_of_00016.arrow
Process #12 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00012_of_00016.arrow
Process #13 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00013_of_00016.arrow
Process #14 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00014_of_00016.arrow
Process #15 will write at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_00015_of_00016.arrow
Loading cached processed dataset at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-01d88b9db3733f12_*_of_00016.arrow
Concatenating 16 shards
input_ids:
[149, 224, 23525, 42092, 148, 110, 22654, 26897, 17550, 103, 30335, 23338, 45692, 22654, 17550, 98, 23338, 28981, 30335, 149, 223, 38843, 28981, 22654, 29519, 30335, 38843, 22654, 28981, 149, 223, 26897, 23338, 45692, 22654, 148, 234, 17550, 118, 34247, 107, 26897, 47048, 13862, 41486, 149, 224, 149, 231, 366, 45692, 149, 223, 26897, 34247, 94, 28981, 148, 255, 30335, 12919, 26897, 17550, 101, 22654, 23338, 28981, 148, 96, 38843, 22654, 12919, 23338, 1, 148, 234, 28981, 148, 108, 22654, 220, 12919, 23338, 148, 115, 13862, 149, 224, 17550, 101, 41486, 30335, 23338, 45692, 18923, 232, 30335, 25405, 28981, 148, 96, 148, 255, 38843, 148, 234, 366, 41486, 148, 105, 23338, 39848, 149, 233, 12919, 220, 13862, 148, 96, 22654, 220, 13862, 39848, 45692, 1911, 198, 30335, 148, 96, 30335, 148, 114, 148, 255, 42092, 148, 110, 22654, 26897, 28981, 148, 112, 148, 97, 30335, 23338, 28981, 38843, 22654, 23338, 22654, 45632, 148, 234, 17550, 96, 148, 255, 25405, 38843, 17550, 117, 148, 116, 30335, 25405, 148, 234, 18923, 223, 22654, 17550, 103, 148, 113, 26897, 22654, 148, 255, 34247, 103, 17550, 98, 44690, 13862, 12919, 25405, 22654, 149, 239, 45632, 148, 234, 17550, 96, 23338, 28981, 30335, 149, 223, 38843, 28981, 22654, 29519, 30335, 38843, 22654, 28981, 149, 223, 26897, 23338, 45692, 22654, 366, 148, 118, 22654, 26897, 47048, 44690, 23338, 22654, 1, 17550, 101, 149, 224, 26897, 12919, 26897, 18923, 224, 148, 114, 34247, 99, 22654, 17550, 103, 30335, 23338, 45692, 22654, 18923, 232, 149, 224, 148, 114, 22654, 17550, 101, 25405, 23338, 44690, 47048, 23338, 148, 116, 25405, 45632, 28981, 149, 225, 148, 112, 12919, 149, 223, 45632, 28981, 41486, 30335, 23338, 45692, 22654, 45632, 47048, 23338, 18923, 224, 39848, 30335, 13862, 47048, 148, 112, 12919, 26897, 149, 225, 22654, 23338, 17550, 98, 45692, 26897, 34247, 99, 22654, 13862, 22654, 22654, 23338, 18923, 223, 22654, 18923, 229, 148, 108, 12919, 28981, 25405, 13862, 41486, 149, 224, 149, 231, 13, 198, 30335, 149, 224, 23525, 17550, 117, 148, 116, 30335, 25405, 148, 234, 18923, 223, 22654, 18923, 225, 13862, 25405, 41486, 29519, 17550, 96, 25405, 12919, 25405, 28981, 25405, 13862, 41486, 149, 224, 149, 231, 148, 234, 17550, 98, 23338, 149, 239, 28981, 25405, 13862, 41486, 149, 224, 149, 231, 28981, 149, 225, 148, 112, 149, 223, 22654, 28981, 44690, 23525, 25405, 22654, 366, 45692, 149, 223, 26897, 34247, 94, 28981, 148, 255, 30335, 12919, 26897, 17550, 101, 22654, 23338, 28981, 148, 96, 38843, 22654, 12919, 23338, 1, 148, 234, 18923, 232, 149, 237, 45692, 12919, 29519, 25405, 18923, 223, 22654, 28981, 41486, 44690, 12919, 22654, 148, 112, 28981, 45692, 13862, 25405, 22654, 42092, 23338, 39848, 148, 108, 28981, 41486, 148, 115, 26897, 149, 223, 42092, 23525, 44690, 23338, 149, 223, 13, 198, 30335, 148, 96, 148, 112, 12919, 26897, 17550, 98, 13862, 149, 231, 17550, 96, 23338, 149, 239, 366, 30335, 148, 255, 38843, 45632, 28981, 148, 113, 149, 223, 17550, 101, 22654, 23338, 28981, 148, 112, 44690, 30335, 39848, 18923, 223, 22654, 18923, 229, 148, 108, 29519, 28981, 13862, 148, 255, 148, 116, 45632, 28981, 149, 223, 12919, 26897, 149, 224, 45632, 148, 234, 18923, 229, 22654, 28981, 148, 114, 12919, 25405, 23338, 220, 13862, 13862, 41486, 44690, 12919, 22654, 148, 112, 28981, 45692, 13862, 25405, 22654, 17550, 101, 44690, 22654, 38843, 149, 233, 12919, 17550, 117, 23338, 28981, 149, 225, 26897, 12919, 29519, 22654, 45632, 42092, 23525, 41486, 44690, 148, 113, 39848, 17550, 117, 13862, 149, 231, 17550, 96, 45692, 34247, 111, 28981, 38843, 22654, 23338, 1911, 198, 25405, 23338, 17550, 105, 12919, 23338, 39848, 29519, 148, 234, 220, 34247, 117, 41486, 39848, 26897, 28981, 149, 224, 34247, 99, 38843, 28981, 44690, 12919, 25405, 220, 13862, 13862, 149, 225, 148, 112, 12919, 149, 223, 45632, 28981, 41486, 30335, 23338, 45692, 22654, 45632, 148, 234, 42092, 148, 255, 22654, 38843, 28981, 44690, 39848, 22654, 38843, 22654, 148, 234, 18923, 223, 22654, 18923, 225, 13862, 25405, 41486, 29519, 148, 234, 17550, 96, 23338, 366, 23525, 25405, 13862, 41486, 149, 224, 149, 231, 47048, 23338, 34247, 111, 39848, 45632, 220, 13862, 38843, 149, 223, 44690, 47048, 45692, 12919, 26897, 28981, 148, 255, 30335, 12919, 26897, 17550, 101, 22654, 23338, 28981, 148, 96, 38843, 22654, 12919, 23338, 42092, 23525, 148, 104, 149, 224, 12919, 149, 223, 34247, 103, 42092, 13862, 41486, 30335, 149, 223, 22654, 26897, 28981, 148, 96, 25405, 23338, 42092, 23525, 45692, 13862, 25405, 1911, 198, 30335, 148, 96, 148, 112, 12919, 26897, 17550, 98, 13862, 149, 231, 17550, 96, 23338, 1987, 17550, 105, 23338, 45692, 22654, 45632, 47048, 30335, 148, 110, 44690, 22654, 23338, 17550, 117, 13862, 149, 231, 718, 17550, 107, 22654, 12919, 23338, 34247, 103, 148, 234, 18923, 232, 148, 112, 12919, 26897, 149, 225, 30335, 23338, 18923, 223, 22654, 18923, 229, 148, 108, 12919, 28981, 25405, 13862, 41486, 149, 224, 149, 231, 28981, 44690, 23525, 25405, 22654, 28981, 148, 96, 30335, 13862, 47048, 23338, 18923, 228, 30335, 44690, 29519, 148, 234, 42092, 23525, 148, 108, 149, 239, 22654, 18923, 232, 41486, 30335, 34247, 113, 13862, 17550, 255, 41486, 149, 231, 807, 18923, 228, 30335, 149, 223, 25405, 39848, 26897, 14, 41486, 148, 112, 26897, 22654, 23338, 28981, 148, 104, 12919, 23338, 22654, 28981, 148, 105, 12919, 26897, 22654, 13, 198, 30335, 22654, 148, 106, 41486, 41486, 25405, 28981, 25405, 13862, 41486, 149, 224, 149, 231, 17550, 96, 44690, 25405, 23525, 29519, 17550, 101, 148, 98, 148, 113, 38843, 12919, 26897, 366, 30335, 148, 104, 22654, 149, 224, 45632, 17550, 103, 30335, 23338, 45692, 1, 220, 13862, 45692, 149, 223, 26897, 34247, 94, 28981, 148, 255, 30335, 12919, 26897, 17550, 101, 22654, 23338, 28981, 148, 96, 38843, 22654, 12919, 23338, 28981, 41486, 22654, 17550, 111, 41486, 148, 112, 149, 225, 13862, 220, 13862, 39848, 23338, 45632, 17550, 96, 30335, 13862, 149, 231, 148, 234, 220, 13862, 148, 106, 13862, 149, 224, 47048, 23338, 34247, 101, 26897, 17550, 255, 30335, 12919, 26897, 17550, 107, 34247, 106, 13862, 28981, 25405, 23338, 148, 116, 25405, 34247, 103, 28981, 149, 225, 148, 112, 149, 223, 22654, 45632, 17550, 106, 13862, 23525, 28981, 25405, 148, 97, 41486, 25405, 26897, 34247, 103, 28981, 44690, 23525, 25405, 22654, 45632, 28981, 25405, 149, 224, 39848, 13862]
inputs:
قال وزير تونسي إن الوفد اليهودي الفرنسي، غادر ملتقى "سفراء الحوار بين الأديان"، الذي انطلق بتونس يوم الأحد، "تجنبًا لأي لبس".
وأوضح وزير الشؤون الدينية، أحمد عظوم، في تصريحات إعلاميّة، أن الوفد اليهودي الفرنسي "غير معني" بقرار قضائي تونسي يقضي بمنع منظمة الكشافة التونسية من قبول مشاركين إسرائيليين في هذا الملتقى.
وقال عظوم، في كلمته أمام الملتقى، إنّ الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، يُساهم في التعايش السلمي ونبذ التطرف والعنف.
وأشار إلى أنّ "وحدة الصف بين الشعوب في هذه اللحظة الفارقة، هي الضامن للتعايش السلمي بعيدًا عن الكراهية والتعصب على أساس الدين".
من جانبه، اعتبر القائد العام للكشافة التونسية، وحيد العبيدي، في كلمته، أن "الملتقى مناسبة لدفع مسار الحوار بين الأديان والثقافات ولتوفير الأمن والسلم".
وأشار إلى أن 24 جنسية موزعين على 6 ديانات، يشاركون في هذا الملتقى العالمي الأول من نوعه، والذّي يتواصل حتى 8 نوفمبر/تشرين الثاني الجاري.
ويختتم الملتقى أعماله بإصدار "وثيقة تونس" لسفراء الحوار بين الأديان التي ستشكل لبنة أولى، لخلق منابر حوار داخل المنظمات الكشفية خلال المؤتمرات العالمية المقبل
03/25/2024 15:41:36 - WARNING - llmtuner.data.utils - Checksum failed: mismatched SHA-1 hash value at data/ar_1b.jsonl.
03/25/2024 15:41:36 - WARNING - llmtuner.data.utils - Checksum failed: mismatched SHA-1 hash value at data/ar_1b.jsonl.
03/25/2024 15:41:36 - WARNING - llmtuner.data.utils - Checksum failed: mismatched SHA-1 hash value at data/ar_1b.jsonl.
Dataset({
    features: ['text'],
    num_rows: 369160
})
{'text': 'قال وزير تونسي إن الوفد اليهودي الفرنسي، غادر ملتقى "سفراء الحوار بين الأديان"، الذي انطلق بتونس يوم الأحد، "تجنبًا لأي لبس".\nوأوضح وزير الشؤون الدينية، أحمد عظوم، في تصريحات إعلاميّة، أن الوفد اليهودي الفرنسي "غير معني" بقرار قضائي تونسي يقضي بمنع منظمة الكشافة التونسية من قبول مشاركين إسرائيليين في هذا الملتقى.\nوقال عظوم، في كلمته أمام الملتقى، إنّ الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، يُساهم في التعايش السلمي ونبذ التطرف والعنف.\nوأشار إلى أنّ "وحدة الصف بين الشعوب في هذه اللحظة الفارقة، هي الضامن للتعايش السلمي بعيدًا عن الكراهية والتعصب على أساس الدين".\nمن جانبه، اعتبر القائد العام للكشافة التونسية، وحيد العبيدي، في كلمته، أن "الملتقى مناسبة لدفع مسار الحوار بين الأديان والثقافات ولتوفير الأمن والسلم".\nوأشار إلى أن 24 جنسية موزعين على 6 ديانات، يشاركون في هذا الملتقى العالمي الأول من نوعه، والذّي يتواصل حتى 8 نوفمبر/تشرين الثاني الجاري.\nويختتم الملتقى أعماله بإصدار "وثيقة تونس" لسفراء الحوار بين الأديان التي ستشكل لبنة أولى، لخلق منابر حوار داخل المنظمات الكشفية خلال المؤتمرات العالمية المقبلة.\nوانطلقت في مدينة الحمامات التونسية، مساء الأحد، أعمال الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، بمشاركة أكثر 150 شخصًا من 24 دولة.\nويهدف الملتقى، الذي يستمر 4 أيام، للعمل على تبني الحوار في المناهج الكشفية، وترسيخ ثقافة الحوار والتعايش بين الأديان.\nأصيب، اليوم الاثنين، مواطن، بالرصاص الحي عقب اقتحام قوات الاحتلال منزله واعتقال نجله في بلدة حلحول شمال الخليل، جنوب الضفة الغربية.'}
Dataset({
    features: ['text'],
    num_rows: 369160
})
{'text': 'قال وزير تونسي إن الوفد اليهودي الفرنسي، غادر ملتقى "سفراء الحوار بين الأديان"، الذي انطلق بتونس يوم الأحد، "تجنبًا لأي لبس".\nوأوضح وزير الشؤون الدينية، أحمد عظوم، في تصريحات إعلاميّة، أن الوفد اليهودي الفرنسي "غير معني" بقرار قضائي تونسي يقضي بمنع منظمة الكشافة التونسية من قبول مشاركين إسرائيليين في هذا الملتقى.\nوقال عظوم، في كلمته أمام الملتقى، إنّ الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، يُساهم في التعايش السلمي ونبذ التطرف والعنف.\nوأشار إلى أنّ "وحدة الصف بين الشعوب في هذه اللحظة الفارقة، هي الضامن للتعايش السلمي بعيدًا عن الكراهية والتعصب على أساس الدين".\nمن جانبه، اعتبر القائد العام للكشافة التونسية، وحيد العبيدي، في كلمته، أن "الملتقى مناسبة لدفع مسار الحوار بين الأديان والثقافات ولتوفير الأمن والسلم".\nوأشار إلى أن 24 جنسية موزعين على 6 ديانات، يشاركون في هذا الملتقى العالمي الأول من نوعه، والذّي يتواصل حتى 8 نوفمبر/تشرين الثاني الجاري.\nويختتم الملتقى أعماله بإصدار "وثيقة تونس" لسفراء الحوار بين الأديان التي ستشكل لبنة أولى، لخلق منابر حوار داخل المنظمات الكشفية خلال المؤتمرات العالمية المقبلة.\nوانطلقت في مدينة الحمامات التونسية، مساء الأحد، أعمال الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، بمشاركة أكثر 150 شخصًا من 24 دولة.\nويهدف الملتقى، الذي يستمر 4 أيام، للعمل على تبني الحوار في المناهج الكشفية، وترسيخ ثقافة الحوار والتعايش بين الأديان.\nأصيب، اليوم الاثنين، مواطن، بالرصاص الحي عقب اقتحام قوات الاحتلال منزله واعتقال نجله في بلدة حلحول شمال الخليل، جنوب الضفة الغربية.'}
Dataset({
    features: ['text'],
    num_rows: 369160
})
{'text': 'قال وزير تونسي إن الوفد اليهودي الفرنسي، غادر ملتقى "سفراء الحوار بين الأديان"، الذي انطلق بتونس يوم الأحد، "تجنبًا لأي لبس".\nوأوضح وزير الشؤون الدينية، أحمد عظوم، في تصريحات إعلاميّة، أن الوفد اليهودي الفرنسي "غير معني" بقرار قضائي تونسي يقضي بمنع منظمة الكشافة التونسية من قبول مشاركين إسرائيليين في هذا الملتقى.\nوقال عظوم، في كلمته أمام الملتقى، إنّ الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، يُساهم في التعايش السلمي ونبذ التطرف والعنف.\nوأشار إلى أنّ "وحدة الصف بين الشعوب في هذه اللحظة الفارقة، هي الضامن للتعايش السلمي بعيدًا عن الكراهية والتعصب على أساس الدين".\nمن جانبه، اعتبر القائد العام للكشافة التونسية، وحيد العبيدي، في كلمته، أن "الملتقى مناسبة لدفع مسار الحوار بين الأديان والثقافات ولتوفير الأمن والسلم".\nوأشار إلى أن 24 جنسية موزعين على 6 ديانات، يشاركون في هذا الملتقى العالمي الأول من نوعه، والذّي يتواصل حتى 8 نوفمبر/تشرين الثاني الجاري.\nويختتم الملتقى أعماله بإصدار "وثيقة تونس" لسفراء الحوار بين الأديان التي ستشكل لبنة أولى، لخلق منابر حوار داخل المنظمات الكشفية خلال المؤتمرات العالمية المقبلة.\nوانطلقت في مدينة الحمامات التونسية، مساء الأحد، أعمال الملتقى الكشفي العالمي "سفراء الحوار بين الأديان"، بمشاركة أكثر 150 شخصًا من 24 دولة.\nويهدف الملتقى، الذي يستمر 4 أيام، للعمل على تبني الحوار في المناهج الكشفية، وترسيخ ثقافة الحوار والتعايش بين الأديان.\nأصيب، اليوم الاثنين، مواطن، بالرصاص الحي عقب اقتحام قوات الاحتلال منزله واعتقال نجله في بلدة حلحول شمال الخليل، جنوب الضفة الغربية.'}
Loading cached shuffled indices for dataset at /home/wangzj/.cache/huggingface/datasets/json/default-59cb3ddd10a01018/0.0.0/8bb11242116d547c741b2e8a1f18598ffdd40a1d4f2a2872c7a28b697434bc96/cache-d59fe843553f11d0.arrow
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 1072999
})
PhiForCausalLM(
  (model): PhiModel(
    (embed_tokens): Embedding(51200, 2560)
    (embed_dropout): Dropout(p=0.0, inplace=False)
    (layers): ModuleList(
      (0): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (1): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (2): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (3): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (4): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (5): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (6): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (7): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (8): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (9): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (10): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (11): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (12): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (13): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (14): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (15): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (16): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (17): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (18): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (19): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (20): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (21): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (22): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (23): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (24): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (25): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (26): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (27): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (28): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (29): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (30): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (31): PhiDecoderLayer(
        (self_attn): PhiAttention(
          (q_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (k_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (v_proj): Linear(in_features=2560, out_features=2560, bias=True)
          (dense): Linear(in_features=2560, out_features=2560, bias=True)
          (rotary_emb): PhiRotaryEmbedding()
        )
        (mlp): PhiMLP(
          (activation_fn): NewGELUActivation()
          (fc1): Linear(in_features=2560, out_features=10240, bias=True)
          (fc2): Linear(in_features=10240, out_features=2560, bias=True)
        )
        (input_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (final_layernorm): LayerNorm((2560,), eps=1e-05, elementwise_affine=True)
  )
  (lm_head): Linear(in_features=2560, out_features=51200, bias=True)
)
Detected kernel version 4.15.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[INFO|trainer.py:586] 2024-03-25 15:41:37,900 >> Using auto half precision backend
[2024-03-25 15:41:38,076] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.12.3, git-hash=unknown, git-branch=unknown
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 1072999
})
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 1072999
})
Dataset({
    features: ['input_ids', 'attention_mask'],
    num_rows: 1072999
})
[2024-03-25 15:41:44,136] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-03-25 15:41:44,137] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-03-25 15:41:44,138] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-03-25 15:41:44,158] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2024-03-25 15:41:44,158] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2024-03-25 15:41:44,158] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2024-03-25 15:41:44,158] [INFO] [stage_1_and_2.py:147:__init__] Reduce bucket size 500000000
[2024-03-25 15:41:44,158] [INFO] [stage_1_and_2.py:148:__init__] Allgather bucket size 500000000
[2024-03-25 15:41:44,158] [INFO] [stage_1_and_2.py:149:__init__] CPU Offload: False
[2024-03-25 15:41:44,158] [INFO] [stage_1_and_2.py:150:__init__] Round robin gradient partitioning: False
[2024-03-25 15:41:52,610] [INFO] [utils.py:802:see_memory_usage] Before initializing optimizer states
[2024-03-25 15:41:52,611] [INFO] [utils.py:803:see_memory_usage] MA 7.77 GB         Max_MA 7.77 GB         CA 7.79 GB         Max_CA 8 GB 
[2024-03-25 15:41:52,611] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 16.4 GB, percent = 7.6%
[2024-03-25 15:41:52,799] [INFO] [utils.py:802:see_memory_usage] After initializing optimizer states
[2024-03-25 15:41:52,799] [INFO] [utils.py:803:see_memory_usage] MA 12.95 GB         Max_MA 20.71 GB         CA 20.74 GB         Max_CA 21 GB 
[2024-03-25 15:41:52,800] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 16.41 GB, percent = 7.6%
[2024-03-25 15:41:52,800] [INFO] [stage_1_and_2.py:514:__init__] optimizer state initialized
[2024-03-25 15:41:52,956] [INFO] [utils.py:802:see_memory_usage] After initializing ZeRO optimizer
[2024-03-25 15:41:52,956] [INFO] [utils.py:803:see_memory_usage] MA 12.95 GB         Max_MA 12.95 GB         CA 20.74 GB         Max_CA 21 GB 
[2024-03-25 15:41:52,957] [INFO] [utils.py:810:see_memory_usage] CPU Virtual Memory:  used = 16.41 GB, percent = 7.6%
[2024-03-25 15:41:52,960] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2024-03-25 15:41:52,960] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-03-25 15:41:52,960] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-03-25 15:41:52,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2024-03-25 15:41:52,961] [INFO] [config.py:974:print] DeepSpeedEngine configuration:
[2024-03-25 15:41:52,961] [INFO] [config.py:978:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-03-25 15:41:52,961] [INFO] [config.py:978:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-03-25 15:41:52,961] [INFO] [config.py:978:print]   amp_enabled .................. False
[2024-03-25 15:41:52,961] [INFO] [config.py:978:print]   amp_params ................... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   bfloat16_enabled ............. False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   checkpoint_parallel_write_pipeline  False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   checkpoint_tag_validation_enabled  True
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   checkpoint_tag_validation_fail  False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f6c580a1d20>
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   communication_data_type ...... None
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   curriculum_enabled_legacy .... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   curriculum_params_legacy ..... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   data_efficiency_enabled ...... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   dataloader_drop_last ......... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   disable_allgather ............ False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   dump_state ................... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_enabled ........... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_gas_boundary_resolution  1
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_layer_num ......... 0
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_max_iter .......... 100
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_stability ......... 1e-06
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_tol ............... 0.01
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   eigenvalue_verbose ........... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   elasticity_enabled ........... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   fp16_auto_cast ............... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   fp16_enabled ................. True
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   fp16_master_weights_and_gradients  False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   global_rank .................. 0
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   grad_accum_dtype ............. None
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   gradient_accumulation_steps .. 8
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   gradient_clipping ............ 1.0
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   gradient_predivide_factor .... 1.0
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   initial_dynamic_scale ........ 65536
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   load_universal_checkpoint .... False
[2024-03-25 15:41:52,962] [INFO] [config.py:978:print]   loss_scale ................... 0
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   memory_breakdown ............. False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   mics_hierarchial_params_gather  False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   mics_shard_size .............. -1
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   optimizer_legacy_fusion ...... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   optimizer_name ............... None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   optimizer_params ............. None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   pld_enabled .................. False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   pld_params ................... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   prescale_gradients ........... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   scheduler_name ............... None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   scheduler_params ............. None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   seq_parallel_communication_data_type  torch.float32
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   sparse_attention ............. None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   sparse_gradients_enabled ..... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   steps_per_print .............. inf
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   train_batch_size ............. 256
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   train_micro_batch_size_per_gpu  8
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   use_node_local_storage ....... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   wall_clock_breakdown ......... False
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   weight_quantization_config ... None
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   world_size ................... 4
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   zero_allow_untested_optimizer  True
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   zero_enabled ................. True
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   zero_force_ds_cpu_optimizer .. True
[2024-03-25 15:41:52,963] [INFO] [config.py:978:print]   zero_optimization_stage ...... 2
[2024-03-25 15:41:52,963] [INFO] [config.py:964:print_user_config]   json = {
    "train_batch_size": 256, 
    "train_micro_batch_size_per_gpu": 8, 
    "gradient_accumulation_steps": 8, 
    "gradient_clipping": 1.0, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "initial_scale_power": 16, 
        "loss_scale_window": 1000, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "zero_optimization": {
        "stage": 2, 
        "allgather_partitions": true, 
        "allgather_bucket_size": 5.000000e+08, 
        "overlap_comm": true, 
        "reduce_scatter": true, 
        "reduce_bucket_size": 5.000000e+08, 
        "contiguous_gradients": true
    }, 
    "steps_per_print": inf, 
    "bf16": {
        "enabled": false
    }
}
[INFO|trainer.py:1747] 2024-03-25 15:41:52,963 >> ***** Running training *****
[INFO|trainer.py:1748] 2024-03-25 15:41:52,963 >>   Num examples = 1,072,999
[INFO|trainer.py:1749] 2024-03-25 15:41:52,963 >>   Num Epochs = 1
[INFO|trainer.py:1750] 2024-03-25 15:41:52,964 >>   Instantaneous batch size per device = 8
[INFO|trainer.py:1753] 2024-03-25 15:41:52,964 >>   Total train batch size (w. parallel, distributed & accumulation) = 256
[INFO|trainer.py:1754] 2024-03-25 15:41:52,964 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:1755] 2024-03-25 15:41:52,964 >>   Total optimization steps = 4,191
[INFO|trainer.py:1756] 2024-03-25 15:41:52,965 >>   Number of trainable parameters = 2,779,683,840
  0%|          | 0/4191 [00:00<?, ?it/s]  0%|          | 1/4191 [00:38<44:14:00, 38.00s/it][2024-03-25 15:43:08,576] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  0%|          | 2/4191 [01:15<43:57:07, 37.77s/it][2024-03-25 15:43:46,249] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  0%|          | 3/4191 [01:53<43:53:20, 37.73s/it][2024-03-25 15:44:24,014] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 32768, reducing to 16384
  0%|          | 4/4191 [02:31<43:53:45, 37.74s/it][2024-03-25 15:45:01,795] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 16384, reducing to 8192
  0%|          | 5/4191 [03:08<43:54:07, 37.76s/it]  0%|          | 6/4191 [03:46<44:01:25, 37.87s/it]  0%|          | 7/4191 [04:25<44:06:21, 37.95s/it]  0%|          | 8/4191 [05:03<44:09:21, 38.00s/it]  0%|          | 9/4191 [05:41<44:11:04, 38.04s/it]  0%|          | 10/4191 [06:19<44:12:12, 38.06s/it]                                                    {'loss': 3.6965, 'learning_rate': 4.999974714228712e-05, 'epoch': 0.0}
  0%|          | 10/4191 [06:19<44:12:12, 38.06s/it]  0%|          | 11/4191 [06:57<44:14:59, 38.11s/it]  0%|          | 12/4191 [07:35<44:13:46, 38.10s/it]  0%|          | 13/4191 [08:13<44:13:09, 38.10s/it]  0%|          | 14/4191 [08:51<44:11:18, 38.08s/it]  0%|          | 15/4191 [09:29<44:11:22, 38.09s/it]  0%|          | 16/4191 [10:08<44:10:42, 38.09s/it]  0%|          | 17/4191 [10:46<44:10:52, 38.11s/it]  0%|          | 18/4191 [11:24<44:10:37, 38.11s/it]  0%|          | 19/4191 [12:02<44:09:12, 38.10s/it]  0%|          | 20/4191 [12:40<44:08:53, 38.10s/it]                                                    {'loss': 2.256, 'learning_rate': 4.999820191923166e-05, 'epoch': 0.0}
  0%|          | 20/4191 [12:40<44:08:53, 38.10s/it]  1%|          | 21/4191 [13:18<44:08:50, 38.11s/it]  1%|          | 22/4191 [13:56<44:07:40, 38.11s/it]  1%|          | 23/4191 [14:34<44:06:15, 38.09s/it]  1%|          | 24/4191 [15:12<44:06:27, 38.11s/it]  1%|          | 25/4191 [15:51<44:05:43, 38.10s/it]base.sh: line 23: 23230 Killed                  deepspeed --num_gpus 4 --master_port=9901 src/train_bash.py --deepspeed /home/wangzj/LLaMA-Factory/llama-pt/config/ds_config.json --stage pt --model_name_or_path /home/nfs02/model/phi-2 --do_train --dataset ar_1b --preprocessing_num_workers 16 --cutoff_len 1024 --finetuning_type full --output_dir /home/nfs03/wangzj/checkpoints/mot/phi-nonexpanded-ar1b --overwrite_output_dir --per_device_train_batch_size 8 --gradient_accumulation_steps 8 --lr_scheduler_type cosine --logging_steps 10 --save_total_limit 1 --save_only_model --save_steps 100000 --learning_rate 5e-5 --num_train_epochs 1.0 --plot_loss --fp16
base.sh: line 24: chs: command not found
